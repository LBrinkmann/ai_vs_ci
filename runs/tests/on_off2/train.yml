exec:
  command: train
  script_name: gpu
labels:
  project: ai_vs_ci
  batch: madqn_on_off
grid:
  - - params.controller_args.ci.mix_freq: null
      params.controller_args.ci.wrapper_args.weight_sharing: false
      labels.mix_freq: no_mixing
    - params.controller_args.ci.mix_freq: 1
      params.controller_args.ci.wrapper_args.weight_sharing: false
      labels.mix_freq: one
    - params.controller_args.ci.mix_freq: 5
      params.controller_args.ci.wrapper_args.weight_sharing: false
      labels.mix_freq: five
    - params.controller_args.ci.mix_freq: null
      params.controller_args.ci.wrapper_args.weight_sharing: true
      labels.mix_freq: shared
  - params.controller_args.ci.opt_args.lr: [0.001, 0.0001]
    params.controller_args.ai.opt_args.lr: [0.001, 0.0001]
    labels.lr: [0.001, 0.0001]
params:
  seed: null
  device_name: cuda
  save_interval:
    train: 10
    eval: 1
  scheduler_args:
    episodes: 25000
    eval_period: 10
    eval_setting:
      eps:
        ci: 0.0
        ai: 0.0
      training:
        ci: false
        ai: false
    phases:
      - episode: 0
        setting:
          eps:
            ci: 0.1
            ai: 0.1
          training:
            ci: true
            ai: false
      - episode: 5000
        setting:
          eps:
            ci: 0.1
            ai: 0.1
          training:
            ci: false
            ai: true
      - episode: 10000
        setting:
          eps:
            ci: 0.1
            ai: 0.1
          training:
            ci: true
            ai: false
      - episode: 15000
        setting:
          eps:
            ci: 0.1
            ai: 0.1
          training:
            ci: false
            ai: true
      - episode: 20000
        setting:
          eps:
            ci: 0.1
            ai: 0.1
          training:
            ci: true
            ai: false
  environment_args:
    class_name: network_game
    n_nodes: 20
    n_actions: 4
    episode_steps: 20
    max_history: 5000
    network_period: 2
    mapping_period: 5
    graph_args:
      constrains:
        max_max_degree: 8
        connected: True
      graph_args:
        p: 0.2
      graph_type: erdos_renyi
    reward_args:
      ci:
        ind_anticoordination:
          ci: 1
        ind_crosscoordination:
          ci: -1
      ai:
        ind_anticoordination:
          ci: -1
        ind_crosscoordination:
          ci: 1
    agent_type_args:
      ci:
        mapping_type: fixed
      ai:
        mapping_type: fixed
    control_args:
      correlated: True
      cross_correlated: True
      n_control: 8
  observer_args:
    ci:
      class_name: neighbor
      neighbor_view_args:
        actions_view: ["ci"]
      # control_view_args:
      #   metric_view:
      #     - agent_type: ci
      #       metric_name: global_coordination
      #     - agent_type: ci
      #       metric_name: local_coordination
      # control_view: "ci"
    ai:
      class_name: neighbor
      neighbor_view_args:
        actions_view: ["ci"]
  controller_args:
    ai:
      class_name: madqn
      gamma: 0.80
      target_update_freq: 10
      mix_freq: null
      sample_args:
        sample_type: random
        batch_size: 10
        horizon: 20
      opt_args:
        lr: 0.001
      wrapper_args:
        weight_sharing: true
        net_type: pooling_gru
      model_args:
        linear1: true
        rnn1: true
        linear2: true
        rnn2: true
        hidden_size: 20
        pooling_types: ["avg", "max", "sum"]
    ci:
      class_name: madqn
      gamma: 0.80
      target_update_freq: 10
      mix_freq: null
      sample_args:
        sample_type: random
        batch_size: 10
        horizon: 20
      opt_args:
        lr: 0.001
      wrapper_args:
        weight_sharing: false
        mix_weights_args:
          noise_factor: 0.0
          mixing_factor: 1.0
        # action_permutation: False
        net_type: pooling_gru
      model_args:
        linear1: true
        rnn1: true
        linear2: true
        rnn2: true
        hidden_size: 20
        pooling_types: ["avg", "max", "sum"]
